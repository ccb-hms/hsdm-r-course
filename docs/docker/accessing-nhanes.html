<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Research Design and Analysis â€“ accessing-nhanes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="../site_libs/datatables-binding-0.29/datatables.js"></script>
<script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../site_libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="../site_libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="../site_libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script>
<link href="../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Research Design and Analysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../readings/readings.html" rel="" target="">
 <span class="menu-text">Readings</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../session-materials/sessions.html" rel="" target="">
 <span class="menu-text">In-Class Materials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../exercises/exercises.html" rel="" target="">
 <span class="menu-text">Exercises</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../resources/resources.html" rel="" target="">
 <span class="menu-text">Resources</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#sec-nhanes" id="toc-sec-nhanes" class="nav-link active" data-scroll-target="#sec-nhanes">Accessing NHANES Data</a>
  <ul class="collapse">
  <li><a href="#through-the-docker-container-reccomended" id="toc-through-the-docker-container-reccomended" class="nav-link" data-scroll-target="#through-the-docker-container-reccomended">Through the Docker container (reccomended)</a>
  <ul class="collapse">
  <li><a href="#installing-phonto" id="toc-installing-phonto" class="nav-link" data-scroll-target="#installing-phonto">Installing Phonto</a></li>
  <li><a href="#accessing-the-phonto-vignettes" id="toc-accessing-the-phonto-vignettes" class="nav-link" data-scroll-target="#accessing-the-phonto-vignettes">Accessing the Phonto vignettes</a></li>
  <li><a href="#using-phonto" id="toc-using-phonto" class="nav-link" data-scroll-target="#using-phonto">Using Phonto</a></li>
  </ul></li>
  <li><a href="#through-nhanesa" id="toc-through-nhanesa" class="nav-link" data-scroll-target="#through-nhanesa">Through nhanesA</a></li>
  <li><a href="#downloading-individual-files" id="toc-downloading-individual-files" class="nav-link" data-scroll-target="#downloading-individual-files">Downloading individual files</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="sec-nhanes" class="level1">
<h1>Accessing NHANES Data</h1>
<p>This page contains 3 ways of accessing NHANES data inside R.</p>
<ol type="1">
<li>Through the dockerized container created by the CCB.</li>
<li>Through the <code>nhanesA</code> package.</li>
<li>Through downloading individual files from the CDC website.</li>
</ol>
<section id="through-the-docker-container-reccomended" class="level2">
<h2 data-anchor-id="through-the-docker-container-reccomended">Through the Docker container (reccomended)</h2>
<p>These steps will allow you to access the NHANES data via a builtin</p>
<p>Connect to RStudio in your browser as shown in the <a href="https://ccb-hms.github.io/hsdm-r-course/resources/install-docker.html#running-rstudio">Accessing NHANES with Docker</a> page.</p>
<section id="installing-phonto" class="level3">
<h3 data-anchor-id="installing-phonto">Installing Phonto</h3>
<p>First we need to install the Phonto package, which is the software used to access the NHANES database inside the container.</p>
<p>In the R console, run the command:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"ccb-hms/phonto"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If successful you should see output similar to:</p>
<pre><code>Downloading GitHub repo ccb-hms/phonto@HEAD
âœ”  checking for file â€˜/tmp/RtmpjKcsPx/remotes8977d6e909/ccb-hms-phonto-121d255/DESCRIPTIONâ€™ ...
â”€  preparing â€˜phontoâ€™:
âœ”  checking DESCRIPTION meta-information
â”€  checking for LF line-endings in source and make files and shell scripts
â”€  checking for empty or unneeded directories
â”€  building â€˜phonto_0.0.0.0069.tar.gzâ€™
   
* installing *source* package â€˜phontoâ€™ ...
** using staged installation
** R
** data
*** moving datasets to lazyload DB
** inst
** byte-compile and prepare package for lazy loading
EpiConductor Container Version: v0.0.4
Data Collection Date: 2023-06-28
** help
*** installing help indices
** building package indices
** installing vignettes
** testing if installed package can be loaded from temporary location
** testing if installed package can be loaded from final location
** testing if installed package keeps a record of temporary installation path
* DONE (phonto)</code></pre>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Timeout Errors
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You may get a timeout error such as this:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"ccb-hms/phonto"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>Error<span class="sc">:</span> Failed to install <span class="st">'phonto'</span> from GitHub<span class="sc">:</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  Timeout was reached<span class="sc">:</span> [api.github.com] Resolving timed out after <span class="dv">10000</span> milliseconds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Or a longer error related to login timing out like this:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"ccb-hms/phonto"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>Downloading GitHub repo ccb<span class="sc">-</span>hms<span class="sc">/</span>phonto<span class="sc">@</span>HEAD</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>âœ”  checking <span class="cf">for</span> file â€˜<span class="sc">/</span>tmp<span class="sc">/</span>RtmpjKcsPx<span class="sc">/</span>remotes895e1b4f91<span class="sc">/</span>ccb<span class="sc">-</span>hms<span class="sc">-</span>phonto<span class="sc">-</span>121d255<span class="sc">/</span>DESCRIPTIONâ€™ (554ms)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>â”€  preparing â€˜phontoâ€™<span class="sc">:</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>âœ”  checking DESCRIPTION meta<span class="sc">-</span>information ...</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>â”€  checking <span class="cf">for</span> LF line<span class="sc">-</span>endings <span class="cf">in</span> source and make files and shell scripts</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>â”€  checking <span class="cf">for</span> empty or unneeded directories</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>â”€  building â€˜phonto_0.<span class="dv">0</span>.<span class="dv">0</span>.<span class="fl">0069.</span>tar.gzâ€™</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> installing <span class="sc">*</span>source<span class="sc">*</span> package â€˜phontoâ€™ ...</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="sc">**</span> using staged installation</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="sc">**</span> R</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="sc">**</span> data</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="sc">**</span><span class="er">*</span> moving datasets to lazyload DB</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="sc">**</span> inst</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="sc">**</span> byte<span class="sc">-</span>compile and prepare package <span class="cf">for</span> lazy loading</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>Error <span class="sc">:</span> nanodbc<span class="sc">/</span>nanodbc.cpp<span class="sc">:</span><span class="dv">1021</span><span class="sc">:</span> <span class="dv">00000</span><span class="sc">:</span> [Microsoft][ODBC Driver <span class="dv">17</span> <span class="cf">for</span> SQL Server]Login timeout expired  [Microsoft][ODBC Driver <span class="dv">17</span> <span class="cf">for</span> SQL Server]TCP Provider<span class="sc">:</span> Timeout error [<span class="dv">258</span>].   [Microsoft][ODBC Driver <span class="dv">17</span> <span class="cf">for</span> SQL Server]Unable to complete login process due to delay <span class="cf">in</span> login response  [Microsoft][ODBC Driver <span class="dv">17</span> <span class="cf">for</span> SQL Server]Invalid connection string attribute </span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>Error<span class="sc">:</span> unable to load R code <span class="cf">in</span> package â€˜phontoâ€™</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>Execution halted</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>ERROR<span class="sc">:</span> lazy loading failed <span class="cf">for</span> package â€˜phontoâ€™</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="sc">*</span> removing â€˜<span class="sc">/</span>usr<span class="sc">/</span>local<span class="sc">/</span>lib<span class="sc">/</span>R<span class="sc">/</span>library<span class="sc">/</span>phontoâ€™</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>Warning message<span class="sc">:</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>In <span class="fu">i.p</span>(...) <span class="sc">:</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  installation of package â€˜<span class="sc">/</span>tmp<span class="sc">/</span>RtmpjKcsPx<span class="sc">/</span>file8930842adb<span class="sc">/</span>phonto_0.<span class="dv">0</span>.<span class="dv">0</span>.<span class="fl">0069.</span>tar.gzâ€™ had non<span class="sc">-</span>zero exit status</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>If you get one of these errors, please retry the installation command. It may take 2-3 tries for the docker container to establish a connection with Github.</p>
</div>
</div>
</div>
</section>
<section id="accessing-the-phonto-vignettes" class="level3">
<h3 data-anchor-id="accessing-the-phonto-vignettes">Accessing the Phonto vignettes</h3>
<p>Like many R packges, the best way to learn how to use Phonto is to go through the included vignettes.</p>
<p>You can access the vignettes inside the Docker container by pulling them from Github.</p>
<p>RStudio has an integrated Git user interface that makes it very easy to use both Git and GitHub. RStudio has integrated Git support which helps to streamline this process. To get a copy of phonto in RStudio do the following:</p>
<ol type="1">
<li>Click <code>File</code> â†’ <code>New Project</code></li>
<li>Select <code>Version Control</code> â†’ <code>Git</code></li>
<li>For the URL choose: <a href="https://github.com/ccb-hms/phonto.git" class="uri">https://github.com/ccb-hms/phonto.git</a></li>
<li>You can choose the name of the project directory.</li>
<li>Choose the folder in which you want to store the R project and Git (you can put this either inside your home directory or navigate to an attached volume).</li>
<li>Click <code>Create Project</code></li>
<li>Check the <code>Files</code> tab to see if you have successfully created the project.</li>
<li>Navigate to <code>phonto/vignettes</code> or directly open <code>phonto/vignettes/quick_start.Rmd</code> or <code>phonto/vignettes/VariableClassification.Rmd</code>.</li>
</ol>
<p><em>Whenever you are working in an RStudio project that has a dedicated Git repository, you can interact with Git through the Git tab (same pane as Environment tab)</em></p>
</section>
<section id="using-phonto" class="level3">
<h3 data-anchor-id="using-phonto">Using Phonto</h3>
<p>While the above vignettes include a variety of examples in how to use phonto to access the NHANES data, letâ€™s take a look at how we accessed the data used in the Beheshti paper.</p>
<section id="searching-nhanes" class="level4">
<h4 data-anchor-id="searching-nhanes">Searching NHANES</h4>
<p>To start, if we donâ€™t know the variable weâ€™re interested in, we can search for keywords using `<code>nhanesSearch</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>hba1c <span class="ot">=</span> <span class="fu">nhanesSearch</span>(<span class="st">"glycohemoglobin"</span>, <span class="at">ignore.case=</span><span class="cn">TRUE</span>, <span class="at">ystart =</span> <span class="dv">2005</span>, <span class="at">ystop=</span><span class="dv">2010</span>, <span class="at">namesonly =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code> Variable.Name Variable.Description Data.File.Name Data.File.Description Begin.Year EndYear  Component
1         LBXGH  Glycohemoglobin (%)          GHB_D       Glycohemoglobin       2005    2006 Laboratory
2         LBXGH  Glycohemoglobin (%)          GHB_E       Glycohemoglobin       2007    2008 Laboratory
3         LBXGH  Glycohemoglobin (%)          GHB_F       Glycohemoglobin       2009    2010 Laboratory</code></pre>
<p>Alternatively, we can look up table definitions.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">nhanesSearchTableNames</span>(<span class="st">"DEM"</span>, <span class="at">details=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>   TableName     Years
1       DEMO 1999-2000
2     DEMO_B 2001-2002
3     DEMO_C 2003-2004
4     DEMO_D 2005-2006
5     DEMO_E 2007-2008
6     DEMO_F 2009-2010
7     DEMO_G 2011-2012
8     DEMO_H 2013-2014
9     DEMO_I 2015-2016
10    DEMO_J 2017-2018</code></pre>
<p>And then check column names.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nhanesColnames</span>(<span class="st">"DEMO_D"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code> [1] "SEQN"     "SDDSRVYR" "RIDSTATR" "RIDEXMON" "RIAGENDR" "RIDAGEYR" "RIDAGEMN" "RIDAGEEX" "RIDRETH1" "DMQMILIT" "DMDBORN"  "DMDCITZN"
[13] "DMDYRSUS" "DMDEDUC3" "DMDEDUC2" "DMDSCHOL" "DMDMARTL" "DMDHHSIZ" "DMDFMSIZ" "INDHHINC" "INDFMINC" "INDFMPIR" "RIDEXPRG" "DMDHRGND"
[25] "DMDHRAGE" "DMDHRBRN" "DMDHREDU" "DMDHRMAR" "DMDHSEDU" "SIALANG"  "SIAPROXY" "SIAINTRP" "FIALANG"  "FIAPROXY" "FIAINTRP" "MIALANG" 
[37] "MIAPROXY" "MIAINTRP" "AIALANG"  "WTINT2YR" "WTMEC2YR" "SDMVPSU"  "SDMVSTRA" "SEQN"     "SDDSRVYR" "RIDSTATR" "RIDEXMON" "RIAGENDR"
[49] "RIDRETH1" "DMQMILIT" "DMDBORN"  "DMDCITZN" "DMDYRSUS" "DMDEDUC3" "DMDEDUC2" "DMDSCHOL" "DMDMARTL" "INDHHINC" "INDFMINC" "RIDEXPRG"
[61] "DMDHRGND" "DMDHRBRN" "DMDHREDU" "DMDHRMAR" "DMDHSEDU" "SIALANG"  "SIAPROXY" "SIAINTRP" "FIALANG"  "FIAPROXY" "FIAINTRP" "MIALANG" 
[73] "MIAPROXY" "MIAINTRP" "AIALANG"  "RIDAGEYR" "RIDAGEMN" "RIDAGEEX" "DMDHHSIZ" "DMDFMSIZ" "INDFMPIR" "DMDHRAGE" "WTINT2YR" "WTMEC2YR"
[85] "SDMVPSU"  "SDMVSTRA"</code></pre>
</section>
<section id="defining-a-query" class="level4">
<h4 data-anchor-id="defining-a-query">Defining a query</h4>
<p>We can define a query to NHANES by creating a list of column names for each table weâ€™re interested in.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>cols_d <span class="ot">=</span> <span class="fu">list</span>(<span class="at">DEMO_D=</span> <span class="fu">c</span>(<span class="st">"RIDAGEYR"</span>,<span class="st">"RIAGENDR"</span>,<span class="st">"RIDRETH1"</span>, </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"DMDBORN"</span>, <span class="st">"INDFMPIR"</span>, <span class="st">"SDMVPSU"</span>, </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"SDMVSTRA"</span>, <span class="st">"WTINT2YR"</span>, <span class="st">"WTMEC2YR"</span>), </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">OHX_D =</span> <span class="fu">c</span>(<span class="st">"OHXDECAY"</span>, <span class="st">"OHXREST"</span>),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">GLU_D =</span> <span class="fu">c</span>(<span class="st">"LBXGLU"</span>, <span class="st">"WTSAF2YR"</span>), <span class="at">GHB_D =</span> <span class="st">"LBXGH"</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">BMX_D=</span> <span class="st">"BMXBMI"</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>cols_e <span class="ot">=</span> <span class="fu">list</span>(<span class="at">DEMO_E=</span> <span class="fu">c</span>(<span class="st">"RIDAGEYR"</span>,<span class="st">"RIAGENDR"</span>,<span class="st">"RIDRETH1"</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"DMDBORN2"</span>, <span class="st">"INDFMPIR"</span>, <span class="st">"SDMVPSU"</span>, </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"SDMVSTRA"</span>, <span class="st">"WTINT2YR"</span>, <span class="st">"WTMEC2YR"</span>), </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">OHX_E =</span> <span class="fu">c</span>(<span class="st">"OHXDECAY"</span>, <span class="st">"OHXREST"</span>),</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">GLU_E =</span> <span class="fu">c</span>(<span class="st">"LBXGLU"</span>, <span class="st">"WTSAF2YR"</span>), </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">GHB_E =</span> <span class="st">"LBXGH"</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">BMX_E =</span> <span class="st">"BMXBMI"</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>cols_f <span class="ot">=</span> <span class="fu">list</span>(<span class="at">DEMO_F=</span> <span class="fu">c</span>(<span class="st">"RIDAGEYR"</span>,<span class="st">"RIAGENDR"</span>,<span class="st">"RIDRETH1"</span>,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"DMDBORN2"</span>, <span class="st">"INDFMPIR"</span>, <span class="st">"SDMVPSU"</span>, </span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"SDMVSTRA"</span>, <span class="st">"WTINT2YR"</span>, <span class="st">"WTMEC2YR"</span>), </span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">OHXDEN_F =</span> <span class="fu">c</span>(<span class="st">"OHXDECAY"</span>, <span class="st">"OHXREST"</span>),</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">GLU_F =</span> <span class="fu">c</span>(<span class="st">"LBXGLU"</span>, <span class="st">"WTSAF2YR"</span>), </span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">GHB_F =</span> <span class="st">"LBXGH"</span>,</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>              <span class="at">BMX_F =</span> <span class="st">"BMXBMI"</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="getting-metadata" class="level4">
<h4 data-anchor-id="getting-metadata">Getting Metadata</h4>
<p>We can get metadata on each column by calling <code>dataDescription</code>. Here we combine years, but note that only unique variable names and variable descriptions are returned, i.e., if the list contains the same questionnaire/variables across different survey years, and if all metadata is consistent, then only one row for this variable will be return.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>all_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(cols_d, cols_e, cols_f)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>metadata <span class="ot">&lt;-</span> <span class="fu">dataDescription</span>(all_cols)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(metadata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>   VariableName                            SASLabel                                                          EnglishText                                     Target
19     DMDBORN2           Country of Birth - Recode                              In what country {were you/was SP} born? Both males and females 0 YEARS - 150 YEARS
20     INDFMPIR   Ratio of family income to poverty                        A ratio of family income to poverty threshold Both males and females 0 YEARS - 150 YEARS
21      SDMVPSU          Masked Variance Pseudo-PSU     Masked Variance Unit Pseudo-PSU variable for variance estimation Both males and females 0 YEARS - 150 YEARS
22     SDMVSTRA      Masked Variance Pseudo-Stratum Masked Variance Unit Pseudo-Stratum variable for variance estimation Both males and females 0 YEARS - 150 YEARS
23     WTINT2YR Full Sample 2 Year Interview Weight                                          Interviewed Sample Persons. Both males and females 0 YEARS - 150 YEARS
24     WTMEC2YR  Full Sample 2 Year MEC Exam Weight                    Both Interviewed and MEC Examined Sample Persons. Both males and females 0 YEARS - 150 YEARS</code></pre>
</section>
<section id="getting-data" class="level4">
<h4 data-anchor-id="getting-data">Getting Data</h4>
<p>We can use <code>jointQuery</code> to get data from NHANES. This will return all columns in the query already translated and combined into a single dataframe for us.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>base_df_d <span class="ot">&lt;-</span> <span class="fu">jointQuery</span>(cols_d)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>base_df_e <span class="ot">&lt;-</span> <span class="fu">jointQuery</span>(cols_e)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>base_df_f <span class="ot">&lt;-</span> <span class="fu">jointQuery</span>(cols_f)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(base_df_d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>   SEQN RIDAGEYR RIAGENDR           RIDRETH1                        DMDBORN INDFMPIR SDMVPSU SDMVSTRA  WTINT2YR  WTMEC2YR OHXDECAY OHXREST LBXGLU WTSAF2YR LBXGH BMXBMI Begin.Year EndYear
1 31127        0     Male Non-Hispanic White "Born in 50 US States or Washi     0.75       2       44  6434.950  6571.396     &lt;NA&gt;    &lt;NA&gt;     NA       NA    NA     NA       2005    2006
2 31128       11   Female Non-Hispanic Black "Born in 50 US States or Washi     0.77       1       52  9081.701  8987.042      Yes      No     NA       NA    NA  17.45       2005    2006
3 31129       15     Male Non-Hispanic Black "Born in 50 US States or Washi     2.71       1       51  5316.895  5586.719       No      No     NA       NA   5.2  26.53       2005    2006
4 31130       85   Female Non-Hispanic White "Born in 50 US States or Washi     1.99       2       46 29960.840 34030.995      Yes     Yes     NA     0.00    NA     NA       2005    2006
5 31131       44   Female Non-Hispanic Black "Born in 50 US States or Washi     4.65       1       48 26457.708 26770.585       No     Yes     90 67556.81   6.0  30.90       2005    2006
6 31132       70     Male Non-Hispanic White "Born in 50 US States or Washi     5.00       2       52 32961.510 35315.539       No     Yes    157 80193.96   7.1  24.74       2005    2006</code></pre>
</section>
</section>
</section>
<section id="through-nhanesa" class="level2">
<h2 data-anchor-id="through-nhanesa">Through nhanesA</h2>
<p>With <code>nhanesA</code>, we can easily download entire tables from NHANES. However, there are some extra processing steps weâ€™ll have to perform compared to using the dockerized database. You can learn more about using <code>nhanesA</code> <a href="https://cran.r-project.org/web/packages/nhanesA/vignettes/Introducing_nhanesA.html">here</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nhanesA)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>â”€â”€ Attaching core tidyverse packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 2.0.0 â”€â”€
âœ” dplyr     1.1.3     âœ” readr     2.1.4
âœ” forcats   1.0.0     âœ” stringr   1.5.0
âœ” ggplot2   3.4.3     âœ” tibble    3.2.1
âœ” lubridate 1.9.2     âœ” tidyr     1.3.0
âœ” purrr     1.0.2     
â”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
âœ– dplyr::filter() masks stats::filter()
âœ– dplyr::lag()    masks stats::lag()
â„¹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Get data with nahnesA</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>DEMO_H <span class="ot">=</span> <span class="fu">nhanes</span>(<span class="st">'DEMO_H'</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>DEMO_I <span class="ot">=</span> <span class="fu">nhanes</span>(<span class="st">'DEMO_I'</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>DPQ_H <span class="ot">=</span> <span class="fu">nhanes</span>(<span class="st">'DPQ_H'</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>DPQ_I <span class="ot">=</span> <span class="fu">nhanes</span>(<span class="st">'DPQ_I'</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Append Files</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>DEMO <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(DEMO_H, DEMO_I)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>DPQ <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(DPQ_H, DPQ_I)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(<span class="fu">head</span>(DEMO))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-3db760dfa8e168cb5215" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3db760dfa8e168cb5215">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6"],[73557,73558,73559,73560,73561,73562],[8,8,8,8,8,8],[2,2,2,2,2,2],[1,1,1,1,2,1],[69,54,72,9,73,56],[null,null,null,null,null,null],[4,3,3,3,3,1],[4,3,3,3,3,1],[1,1,2,1,1,1],[null,null,null,119,null,null],[1,2,1,null,2,1],[1,null,1,null,null,2],[1,1,1,1,1,1],[1,1,1,1,1,1],[null,null,null,null,null,null],[null,null,null,3,null,null],[3,3,4,null,5,4],[4,1,1,null,1,3],[null,null,null,null,null,null],[1,1,1,1,1,1],[2,2,2,1,2,2],[2,2,2,2,2,2],[1,1,1,1,1,1],[2,2,2,2,2,2],[2,2,2,2,2,2],[1,1,1,1,1,1],[2,2,2,2,2,2],[2,2,2,2,2,2],[1,1,null,1,null,1],[3,4,2,4,2,1],[3,4,2,4,2,1],[0,0,0,0,0,0],[0,2,0,2,0,0],[2,0,2,0,2,0],[1,1,1,1,1,1],[69,54,72,33,78,56],[1,1,1,1,1,1],[3,3,4,3,5,4],[4,1,1,1,1,3],[null,1,3,4,5,null],[13281.237386,23682.057386,57214.803319,55201.178592,63709.667069,24978.144602],[13481.042095,24471.769625,57193.285376,55766.512438,65541.871229,25344.992359],[1,1,1,2,2,1],[112,108,109,109,116,111],[4,7,10,9,15,9],[4,7,10,9,15,9],[0.84,1.78,4.51,2.52,5,4.79]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>SEQN<\/th>\n      <th>SDDSRVYR<\/th>\n      <th>RIDSTATR<\/th>\n      <th>RIAGENDR<\/th>\n      <th>RIDAGEYR<\/th>\n      <th>RIDAGEMN<\/th>\n      <th>RIDRETH1<\/th>\n      <th>RIDRETH3<\/th>\n      <th>RIDEXMON<\/th>\n      <th>RIDEXAGM<\/th>\n      <th>DMQMILIZ<\/th>\n      <th>DMQADFC<\/th>\n      <th>DMDBORN4<\/th>\n      <th>DMDCITZN<\/th>\n      <th>DMDYRSUS<\/th>\n      <th>DMDEDUC3<\/th>\n      <th>DMDEDUC2<\/th>\n      <th>DMDMARTL<\/th>\n      <th>RIDEXPRG<\/th>\n      <th>SIALANG<\/th>\n      <th>SIAPROXY<\/th>\n      <th>SIAINTRP<\/th>\n      <th>FIALANG<\/th>\n      <th>FIAPROXY<\/th>\n      <th>FIAINTRP<\/th>\n      <th>MIALANG<\/th>\n      <th>MIAPROXY<\/th>\n      <th>MIAINTRP<\/th>\n      <th>AIALANGA<\/th>\n      <th>DMDHHSIZ<\/th>\n      <th>DMDFMSIZ<\/th>\n      <th>DMDHHSZA<\/th>\n      <th>DMDHHSZB<\/th>\n      <th>DMDHHSZE<\/th>\n      <th>DMDHRGND<\/th>\n      <th>DMDHRAGE<\/th>\n      <th>DMDHRBR4<\/th>\n      <th>DMDHREDU<\/th>\n      <th>DMDHRMAR<\/th>\n      <th>DMDHSEDU<\/th>\n      <th>WTINT2YR<\/th>\n      <th>WTMEC2YR<\/th>\n      <th>SDMVPSU<\/th>\n      <th>SDMVSTRA<\/th>\n      <th>INDHHIN2<\/th>\n      <th>INDFMIN2<\/th>\n      <th>INDFMPIR<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(<span class="fu">head</span>(DPQ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-4ee14b5f0d1a981d6296" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-4ee14b5f0d1a981d6296">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6"],[73557,73558,73559,73561,73562,73564],[1,2,0,2,3,0],[0,0,0,1,3,1],[0,0,0,0,3,0],[0,0,0,3,3,1],[0,0,0,3,3,0],[0,0,0,0,1,0],[0,0,0,0,2,0],[0,0,0,0,1,0],[0,0,0,0,0,0],[1,0,null,1,3,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>SEQN<\/th>\n      <th>DPQ010<\/th>\n      <th>DPQ020<\/th>\n      <th>DPQ030<\/th>\n      <th>DPQ040<\/th>\n      <th>DPQ050<\/th>\n      <th>DPQ060<\/th>\n      <th>DPQ070<\/th>\n      <th>DPQ080<\/th>\n      <th>DPQ090<\/th>\n      <th>DPQ100<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>There are a few differences between this data and the processed data weâ€™ve been using. First, we have to <code>join</code> the DEMO and DPQ tables. Weâ€™ll learn more about joining or merging data in the last week of class.</p>
<p>Second, the values in the raw NHANES tables are numeric encodings for each variable. With nhanesA we can lookup the code using <code>nhanesCodebook</code> and convert numeric codes using <code>nhanesTranslate</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nhanesCodebook</span>(<span class="st">'DEMO_H'</span>, <span class="st">'RIAGENDR'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Variable Name:`
[1] "RIAGENDR"

$`SAS Label:`
[1] "Gender"

$`English Text:`
[1] "Gender of the participant."

$`Target:`
[1] "Both males and females 0 YEARS -\r 150 YEARS"

$RIAGENDR
# A tibble: 3 Ã— 5
  `Code or Value` `Value Description` Count Cumulative `Skip to Item`
  &lt;chr&gt;           &lt;chr&gt;               &lt;int&gt;      &lt;int&gt; &lt;lgl&gt;         
1 1               Male                 5003       5003 NA            
2 2               Female               5172      10175 NA            
3 .               Missing                 0      10175 NA            </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nhanesTranslate</span>(DEMO_H)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Column name is required</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
</section>
<section id="downloading-individual-files" class="level2">
<h2 data-anchor-id="downloading-individual-files">Downloading individual files</h2>
<p>If all else fails, individual files can be downloaded from the CDC website and read into R using the <a href="https://cran.r-project.org/web/packages/foreign/index.html">foreign</a> package. This example is taken from an example analysis put out by the CDC <a href="https://wwwn.cdc.gov/nchs/data/Tutorials/Code/DB303_R.r">here</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Prevalence of Depression Among Adults Aged 20 and Over: United States, 2013-2016 </span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' Brody DJ, Pratt LA, Hughes JP. Prevalence of Depression Among Adults Aged 20 and Over: United          </span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' States, 2013-2016. NCHS Data Brief. No 303. Hyattsville, MD: National Center for Health Statistics. 2018.                     </span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' # Data preparation</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Download &amp; Read SAS Transport Files</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Demographic (DEMO)</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">"https://wwwn.cdc.gov/nchs/nhanes/2013-2014/DEMO_H.XPT"</span>, tf <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(), <span class="at">mode=</span><span class="st">"wb"</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>DEMO_H <span class="ot">&lt;-</span> foreign<span class="sc">::</span><span class="fu">read.xport</span>(tf)[,<span class="fu">c</span>(<span class="st">"SEQN"</span>,<span class="st">"RIAGENDR"</span>,<span class="st">"RIDAGEYR"</span>,<span class="st">"SDMVSTRA"</span>,<span class="st">"SDMVPSU"</span>,<span class="st">"WTMEC2YR"</span>)]</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">"https://wwwn.cdc.gov/nchs/nhanes/2015-2016/DEMO_I.XPT"</span>, tf <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(), <span class="at">mode=</span><span class="st">"wb"</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>DEMO_I <span class="ot">&lt;-</span> foreign<span class="sc">::</span><span class="fu">read.xport</span>(tf)[,<span class="fu">c</span>(<span class="st">"SEQN"</span>,<span class="st">"RIAGENDR"</span>,<span class="st">"RIDAGEYR"</span>,<span class="st">"SDMVSTRA"</span>,<span class="st">"SDMVPSU"</span>,<span class="st">"WTMEC2YR"</span>)]</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Mental Health - Depression Screener (DPQ) </span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">"http://wwwn.cdc.gov/nchs/nhanes/2013-2014/DPQ_H.XPT"</span>, tf <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(), <span class="at">mode=</span><span class="st">"wb"</span>)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>DPQ_H <span class="ot">&lt;-</span> foreign<span class="sc">::</span><span class="fu">read.xport</span>(tf)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">"http://wwwn.cdc.gov/nchs/nhanes/2015-2016/DPQ_I.XPT"</span>, tf <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(), <span class="at">mode=</span><span class="st">"wb"</span>)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>DPQ_I <span class="ot">&lt;-</span> foreign<span class="sc">::</span><span class="fu">read.xport</span>(tf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>